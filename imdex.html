<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#0a0312">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>üíï –° –î–Ω—ë–º –°–≤—è—Ç–æ–≥–æ –í–∞–ª–µ–Ω—Ç–∏–Ω–∞ üíï</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Great+Vibes&family=Cormorant+Garamond:ital,wght@0,400;0,600;1,400&family=Montserrat:wght@300;400;600&display=swap');

        * { margin: 0; padding: 0; box-sizing: border-box; }

        :root {
            --pink: #ff6b8a;
            --deep-pink: #e91e63;
            --rose: #ff1744;
            --gold: #ffd700;
            --dark: #0a0312;
        }

        html, body {
            font-family: 'Montserrat', sans-serif;
            background: var(--dark);
            color: #fff;
            overflow: hidden;
            width: 100%; height: 100%;
            user-select: none;
        }

        /* ===== CANVAS ===== */
        #starfield {
            position: fixed; top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: 0; pointer-events: none;
        }

        /* ===== PETALS ===== */
        .petal {
            position: fixed; pointer-events: none; z-index: 1;
            border-radius: 50% 50% 50% 0; opacity: 0;
            animation: petalFall linear infinite;
        }
        @keyframes petalFall {
            0%   { transform: translateY(-20px) rotate(0deg); opacity: 0; }
            8%   { opacity: 0.85; }
            88%  { opacity: 0.65; }
            100% { transform: translateY(110vh) rotate(800deg) translateX(var(--sway,0px)); opacity: 0; }
        }

        /* ===== PRELOADER ===== */
        #preloader {
            position: fixed; top: 0; left: 0;
            width: 100%; height: 100%;
            background: radial-gradient(ellipse at center, #1a0a2e 0%, #0a0312 100%);
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            z-index: 10000;
            transition: opacity 1.5s ease, visibility 1.5s ease;
        }
        #preloader.hidden { opacity: 0; visibility: hidden; }
        .preloader-heart {
            font-size: 95px;
            animation: heartbeat3d 1.2s ease-in-out infinite;
            filter: drop-shadow(0 0 35px #ff1744);
        }
        @keyframes heartbeat3d {
            0%,100% { transform: scale(1);    filter: drop-shadow(0 0 25px #ff1744); }
            25%     { transform: scale(1.22); filter: drop-shadow(0 0 50px #ff1744); }
            50%     { transform: scale(1);    filter: drop-shadow(0 0 25px #ff1744); }
            75%     { transform: scale(1.14); filter: drop-shadow(0 0 40px #ff6b8a); }
        }
        .preloader-text {
            font-family: 'Great Vibes', cursive; font-size: 38px;
            color: var(--pink); margin-top: 25px; opacity: 0;
            animation: fadeInUp 1s 0.5s forwards;
            text-shadow: 0 0 25px rgba(255,107,138,0.6);
        }
        .preloader-sub {
            font-size: 13px; letter-spacing: 4px; color: rgba(255,255,255,0.45);
            margin-top: 10px; opacity: 0; animation: fadeInUp 1s 0.9s forwards;
            text-transform: uppercase;
        }
        .enter-btn {
            margin-top: 50px; padding: 18px 58px;
            background: linear-gradient(135deg, var(--pink), var(--deep-pink));
            color: #fff; border: none; border-radius: 50px;
            font-family: 'Montserrat', sans-serif; font-size: 18px;
            cursor: pointer; opacity: 0; animation: fadeInUp 1s 1.3s forwards;
            transition: transform 0.3s, box-shadow 0.3s;
            letter-spacing: 2px; position: relative; overflow: hidden;
        }
        .enter-btn::before {
            content: ''; position: absolute; top: -50%; left: -70%;
            width: 35%; height: 200%;
            background: rgba(255,255,255,0.25); transform: skewX(-20deg);
            animation: btnShine 3s 2.5s infinite;
        }
        @keyframes btnShine { 0% { left: -70%; } 100% { left: 130%; } }
        .enter-btn:hover {
            transform: scale(1.09);
            box-shadow: 0 0 55px rgba(255,107,138,0.75), 0 0 100px rgba(255,107,138,0.3);
        }

        /* ===== FLOATING HEARTS ===== */
        #hearts-bg {
            position: fixed; top: 0; left: 0;
            width: 100%; height: 100%;
            pointer-events: none; z-index: 1; overflow: hidden;
        }
        .floating-heart {
            position: absolute; opacity: 0;
            animation: floatUp linear infinite;
        }
        @keyframes floatUp {
            0%   { transform: translateY(100vh) rotate(0deg) scale(0.3); opacity: 0; }
            10%  { opacity: 0.6; }
            90%  { opacity: 0.4; }
            100% { transform: translateY(-120px) rotate(720deg) scale(1.1); opacity: 0; }
        }

        /* ===== SPARKLE ===== */
        .sparkle {
            position: fixed; pointer-events: none; z-index: 9999; font-size: 14px;
            animation: sparkleFade 0.85s forwards;
        }
        @keyframes sparkleFade {
            0%   { opacity: 1; transform: scale(1) translateY(0); }
            100% { opacity: 0; transform: scale(0) translateY(-28px); }
        }

        /* ===== NAV ===== */
        nav {
            position: fixed; top: 0; width: 100%; padding: 12px 0;
            background: rgba(10,3,18,0.88); backdrop-filter: blur(22px);
            z-index: 1000; display: flex; justify-content: center;
            gap: 20px; flex-wrap: wrap;
            border-bottom: 1px solid rgba(255,107,138,0.12);
            opacity: 0; transform: translateY(-100%);
            transition: all 0.9s ease;
        }
        nav.visible { opacity: 1; transform: translateY(0); }
        nav a {
            color: rgba(255,255,255,0.55); text-decoration: none;
            font-size: 11px; letter-spacing: 2px; text-transform: uppercase;
            transition: color 0.3s, text-shadow 0.3s; position: relative;
            cursor: pointer;
        }
        nav a::after {
            content: ''; position: absolute; bottom: -5px; left: 0;
            width: 0%; height: 2px; background: var(--pink); transition: width 0.3s;
        }
        nav a:hover { color: var(--pink); text-shadow: 0 0 15px rgba(255,107,138,0.6); }
        nav a:hover::after { width: 100%; }
        nav a.cur { color: var(--pink); }
        nav a.cur::after { width: 100%; }

        /* ===== SLIDES CONTAINER ===== */
        #slides-wrap {
            position: fixed; top: 0; left: 0;
            width: 100%; height: 100vh;
            overflow: hidden; z-index: 2;
        }

        /* ===== SECTIONS (SLIDES) ===== */
        section {
            position: absolute; top: 0; left: 0;
            width: 100%; height: 100vh;
            overflow-y: auto; overflow-x: hidden;
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            padding: 80px 20px 80px;
            /* Initial: all slides off-screen right */
            transform: translateX(100%);
            opacity: 0;
            pointer-events: none;
            will-change: transform, opacity;
        }
        section::-webkit-scrollbar { width: 4px; }
        section::-webkit-scrollbar-track { background: transparent; }
        section::-webkit-scrollbar-thumb { background: rgba(255,107,138,0.3); border-radius: 2px; }

        /* ===== SLIDE ARROW NAVIGATION ===== */
        .slide-arrow {
            position: fixed; top: 50%; z-index: 1100;
            transform: translateY(-50%);
            width: 48px; height: 48px;
            background: rgba(255,107,138,0.12);
            border: 2px solid rgba(255,107,138,0.35);
            border-radius: 50%; display: flex;
            align-items: center; justify-content: center;
            cursor: pointer; font-size: 22px; color: rgba(255,255,255,0.85);
            transition: all 0.3s; backdrop-filter: blur(12px);
            opacity: 0; visibility: hidden;
        }
        .slide-arrow.ready { opacity: 1; visibility: visible; }
        .slide-arrow:hover {
            background: rgba(255,107,138,0.4);
            box-shadow: 0 0 25px rgba(255,107,138,0.4);
            transform: translateY(-50%) scale(1.12);
        }
        .slide-arrow.dim { opacity: 0.2 !important; pointer-events: none; }
        #slidePrev { left: 14px; }
        #slideNext { right: 80px; }

        /* ===== SLIDE DOTS ===== */
        #slideDots {
            position: fixed; bottom: 18px; left: 50%;
            transform: translateX(-50%); display: flex; gap: 7px;
            z-index: 1100; opacity: 0; visibility: hidden;
            transition: opacity 0.5s;
        }
        #slideDots.ready { opacity: 1; visibility: visible; }
        .slide-dot {
            width: 8px; height: 8px; border-radius: 50%;
            background: rgba(255,255,255,0.25); cursor: pointer;
            transition: all 0.35s;
        }
        .slide-dot.active {
            background: var(--pink); width: 22px; border-radius: 4px;
            box-shadow: 0 0 8px var(--pink);
        }

        /* ===== SLIDE COUNTER ===== */
        #slideCounter {
            position: fixed; bottom: 22px; right: 90px;
            font-size: 12px; color: rgba(255,255,255,0.3);
            letter-spacing: 2px; z-index: 1100;
            opacity: 0; visibility: hidden; transition: opacity 0.5s;
            font-family: 'Montserrat', sans-serif;
        }
        #slideCounter.ready { opacity: 1; visibility: visible; }

        /* ===== SECTION TITLES ===== */
        .section-title {
            font-family: 'Great Vibes', cursive;
            font-size: clamp(36px, 6vw, 60px);
            color: var(--pink); text-align: center; margin-bottom: 45px;
            text-shadow: 0 0 30px rgba(255,107,138,0.45);
        }

        /* ===== HERO ===== */
        #hero {
            background: radial-gradient(ellipse at 50% 55%, rgba(255,107,138,0.07) 0%, transparent 65%);
            text-align: center;
        }
        .hero-content { opacity: 0; transform: translateY(65px); transition: all 1.9s cubic-bezier(0.16,1,0.3,1); }
        .hero-content.visible { opacity: 1; transform: translateY(0); }
        .hero-date { font-size: 13px; letter-spacing: 9px; color: var(--pink); margin-bottom: 22px; text-transform: uppercase; }
        .hero-title {
            font-family: 'Great Vibes', cursive;
            font-size: clamp(48px, 10vw, 105px);
            background: linear-gradient(135deg, #ff6b8a, #ffd700, #ff6b8a, #ff80ab);
            background-size: 300%; -webkit-background-clip: text;
            -webkit-text-fill-color: transparent; background-clip: text;
            animation: gradientShift 4s ease infinite; line-height: 1.2; margin-bottom: 22px;
        }
        @keyframes gradientShift { 0%,100% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } }
        .hero-subtitle {
            font-family: 'Cormorant Garamond', serif;
            font-size: clamp(16px, 2.5vw, 24px);
            color: rgba(255,255,255,0.62); font-style: italic;
            max-width: 560px; margin: 0 auto; line-height: 1.85;
        }
        .big-heart-container { margin-bottom: 25px; position: relative; display: inline-block; }
        .big-heart {
            font-size: 120px; display: inline-block;
            animation: heartbeatMain 1.8s ease-in-out infinite;
            filter: drop-shadow(0 0 40px rgba(255,23,68,0.65));
            cursor: pointer;
        }
        .big-heart:hover { filter: drop-shadow(0 0 80px rgba(255,23,68,1)); }
        .heart-rings { position: absolute; top: 50%; left: 50%; transform: translate(-50%,-50%); pointer-events: none; }
        .heart-ring {
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%,-50%); border-radius: 50%;
            border: 2px solid rgba(255,107,138,0.28);
            animation: ringExpand 2.2s ease-out infinite;
        }
        .heart-ring:nth-child(1) { width: 165px; height: 165px; animation-delay: 0s; }
        .heart-ring:nth-child(2) { width: 205px; height: 205px; animation-delay: 0.55s; }
        .heart-ring:nth-child(3) { width: 248px; height: 248px; animation-delay: 1.1s; }
        @keyframes ringExpand {
            0%   { transform: translate(-50%,-50%) scale(0.75); opacity: 0.9; }
            100% { transform: translate(-50%,-50%) scale(1.55); opacity: 0; }
        }
        @keyframes heartbeatMain {
            0%,100% { transform: scale(1); } 14% { transform: scale(1.18); }
            28% { transform: scale(1); }     42% { transform: scale(1.11); }
        }
        .next-hint {
            margin-top: 30px; font-size: 28px; cursor: pointer;
            animation: bounce 2s infinite; opacity: 0.5;
        }
        @keyframes bounce {
            0%,20%,50%,80%,100% { transform: translateY(0); }
            40% { transform: translateY(-12px); }
            60% { transform: translateY(-6px); }
        }

        /* ===== DECLARATION ===== */
        #declaration { background: radial-gradient(ellipse at center, rgba(255,23,68,0.06) 0%, transparent 65%); }
        .declaration-container { text-align: center; max-width: 700px; }
        .declaration-title {
            font-family: 'Great Vibes', cursive;
            font-size: clamp(30px, 5.5vw, 54px);
            background: linear-gradient(135deg, #ff6b8a, #ffd700);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            background-clip: text; margin-bottom: 10px;
        }
        .declaration-heart-wrap { position: relative; display: inline-block; margin: 18px 0 22px; }
        .decl-rings { position: absolute; top: 50%; left: 50%; transform: translate(-50%,-50%); pointer-events: none; }
        .decl-ring { position: absolute; top: 50%; left: 50%; transform: translate(-50%,-50%); border-radius: 50%; animation: ringExpand 2s ease-out infinite; }
        .decl-ring:nth-child(1) { width: 195px; height: 195px; border: 2px solid rgba(255,107,138,0.3); animation-delay: 0s; }
        .decl-ring:nth-child(2) { width: 255px; height: 255px; border: 2px solid rgba(255,215,0,0.2); animation-delay: 0.7s; }
        .decl-ring:nth-child(3) { width: 315px; height: 315px; border: 1px solid rgba(255,107,138,0.12); animation-delay: 1.4s; }
        .declaration-heart-btn {
            font-size: 155px; cursor: pointer; display: inline-block;
            animation: heartbeatMain 1.6s ease-in-out infinite;
            filter: drop-shadow(0 0 40px rgba(255,23,68,0.55));
            transition: filter 0.3s; position: relative; z-index: 1;
        }
        .declaration-heart-btn:hover { filter: drop-shadow(0 0 85px rgba(255,23,68,1)); }
        .declaration-sub {
            font-family: 'Cormorant Garamond', serif; font-size: 19px;
            color: rgba(255,255,255,0.68); font-style: italic;
            line-height: 1.85; margin-bottom: 18px; max-width: 540px;
        }
        .declaration-hint { font-size: 12px; color: rgba(255,107,138,0.55); letter-spacing: 3px; text-transform: uppercase; animation: hintPulse 2s infinite; }
        @keyframes hintPulse { 0%,100% { opacity: 0.55; } 50% { opacity: 1; } }
        .love-messages { margin-top: 25px; min-height: 65px; display: flex; align-items: center; justify-content: center; }
        .love-msg-text {
            font-family: 'Cormorant Garamond', serif; font-size: 24px;
            color: var(--gold); font-style: italic;
            animation: fadeInUp 0.7s ease; text-shadow: 0 0 20px rgba(255,215,0,0.35);
        }

        /* ===== LETTER ===== */
        #letter { background: radial-gradient(ellipse at 30% 50%, rgba(255,107,138,0.04), transparent 55%); }
        .letter-container {
            max-width: 720px; width: 100%;
            background: linear-gradient(135deg, rgba(255,255,255,0.065), rgba(255,255,255,0.02));
            border: 1px solid rgba(255,107,138,0.22); border-radius: 26px;
            padding: 60px 55px; position: relative; backdrop-filter: blur(18px);
            opacity: 0; transform: translateY(50px) rotateX(8deg);
            transition: all 1.2s cubic-bezier(0.16,1,0.3,1);
            box-shadow: 0 30px 80px rgba(0,0,0,0.35), inset 0 1px 0 rgba(255,255,255,0.08);
        }
        .letter-container.visible { opacity: 1; transform: translateY(0) rotateX(0); }
        .letter-container::before {
            content: 'üíå'; position: absolute; top: -35px; left: 50%;
            transform: translateX(-50%); font-size: 54px;
            filter: drop-shadow(0 6px 18px rgba(255,107,138,0.4));
        }
        .letter-title { font-family: 'Great Vibes', cursive; font-size: 46px; color: var(--pink); text-align: center; margin-bottom: 30px; text-shadow: 0 0 22px rgba(255,107,138,0.35); }
        .letter-text { font-family: 'Cormorant Garamond', serif; font-size: 19px; line-height: 2.1; color: rgba(255,255,255,0.83); text-align: center; min-height: 80px; }
        .letter-text .highlight { color: var(--pink); font-weight: 600; text-shadow: 0 0 12px rgba(255,107,138,0.35); }
        .letter-cursor { display: inline-block; width: 2px; height: 1.1em; background: var(--pink); animation: cursorBlink 0.8s infinite; vertical-align: text-bottom; margin-left: 2px; }
        @keyframes cursorBlink { 0%,49% { opacity: 1; } 50%,100% { opacity: 0; } }
        .letter-signature { font-family: 'Great Vibes', cursive; font-size: 34px; color: var(--gold); text-align: right; margin-top: 30px; text-shadow: 0 0 18px rgba(255,215,0,0.35); }

        /* ===== REASONS ===== */
        #reasons { background: radial-gradient(ellipse at 70% 50%, rgba(106,13,173,0.07), transparent 55%); }
        .reasons-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 22px; max-width: 900px; width: 100%; }
        .reason-card {
            background: linear-gradient(135deg, rgba(255,255,255,0.07), rgba(255,255,255,0.02));
            border: 1px solid rgba(255,107,138,0.14); border-radius: 20px;
            padding: 30px 26px; text-align: center;
            transition: all 0.55s cubic-bezier(0.16,1,0.3,1);
            opacity: 0; transform: translateY(40px) scale(0.94);
            position: relative; overflow: hidden;
        }
        .reason-card::before { content: ''; position: absolute; inset: 0; background: linear-gradient(135deg, rgba(255,107,138,0.07), transparent); opacity: 0; transition: opacity 0.3s; }
        .reason-card:hover::before { opacity: 1; }
        .reason-card.visible { opacity: 1; transform: translateY(0) scale(1); }
        .reason-card:hover { transform: translateY(-12px) scale(1.02); border-color: rgba(255,107,138,0.52); box-shadow: 0 25px 65px rgba(255,107,138,0.2); }
        .reason-icon { font-size: 52px; margin-bottom: 15px; display: inline-block; transition: transform 0.4s cubic-bezier(0.16,1,0.3,1); }
        .reason-card:hover .reason-icon { transform: scale(1.28) rotate(12deg); }
        .reason-title { font-family: 'Cormorant Garamond', serif; font-size: 21px; color: var(--pink); margin-bottom: 10px; font-weight: 600; }
        .reason-desc { font-size: 13px; color: rgba(255,255,255,0.55); line-height: 1.7; }

        /* ===== TIMELINE ===== */
        #timeline { background: radial-gradient(ellipse at 50% 30%, rgba(255,107,138,0.05), transparent 55%); }
        .timeline { position: relative; max-width: 620px; width: 100%; }
        .timeline::before {
            content: ''; position: absolute; left: 50%; top: 0; bottom: 0; width: 2px;
            background: linear-gradient(to bottom, transparent, var(--pink), var(--gold), var(--pink), transparent);
            transform: translateX(-50%);
            animation: timelineGlow 3s ease-in-out infinite;
        }
        @keyframes timelineGlow { 0%,100% { filter: blur(0px); } 50% { filter: blur(1px) drop-shadow(0 0 6px var(--pink)); } }
        .timeline-item { padding: 20px 0; position: relative; opacity: 0; transition: all 0.9s cubic-bezier(0.16,1,0.3,1); }
        .timeline-item:nth-child(odd)  { transform: translateX(-40px); }
        .timeline-item:nth-child(even) { transform: translateX(40px); }
        .timeline-item.visible { opacity: 1; transform: translateX(0); }
        .timeline-dot { position: absolute; left: 50%; top: 30px; width: 17px; height: 17px; background: var(--pink); border-radius: 50%; transform: translateX(-50%); box-shadow: 0 0 18px var(--pink), 0 0 38px rgba(255,107,138,0.4); z-index: 1; animation: dotPulse 2s ease-in-out infinite; }
        @keyframes dotPulse { 0%,100% { box-shadow: 0 0 15px var(--pink); } 50% { box-shadow: 0 0 28px var(--pink), 0 0 50px rgba(255,107,138,0.5); } }
        .timeline-content { width: 44%; background: rgba(255,255,255,0.04); border: 1px solid rgba(255,107,138,0.14); border-radius: 14px; padding: 18px; transition: all 0.3s; }
        .timeline-content:hover { border-color: rgba(255,107,138,0.4); background: rgba(255,107,138,0.06); box-shadow: 0 8px 28px rgba(255,107,138,0.1); }
        .timeline-item:nth-child(even) .timeline-content { margin-left: auto; }
        .timeline-emoji { font-size: 30px; margin-bottom: 6px; }
        .timeline-label { font-family: 'Great Vibes', cursive; font-size: 23px; color: var(--pink); }
        .timeline-desc { font-size: 13px; color: rgba(255,255,255,0.55); margin-top: 5px; line-height: 1.6; }

        /* ===== MEMORY GAME ===== */
        #memory { background: radial-gradient(ellipse at 50% 50%, rgba(255,215,0,0.04), transparent 60%); }
        .memory-intro { text-align: center; margin-bottom: 28px; }
        .memory-intro p { color: rgba(255,255,255,0.55); font-size: 15px; margin-top: 10px; }
        .memory-grid { display: grid; grid-template-columns: repeat(4,1fr); gap: 12px; max-width: 480px; width: 100%; }
        .memory-card { aspect-ratio: 1; perspective: 700px; cursor: pointer; }
        .memory-card-inner { width: 100%; height: 100%; position: relative; transform-style: preserve-3d; transition: transform 0.55s cubic-bezier(0.16,1,0.3,1); }
        .memory-card.flipped .memory-card-inner,
        .memory-card.matched .memory-card-inner { transform: rotateY(180deg); }
        .memory-card-front,
        .memory-card-back { position: absolute; inset: 0; border-radius: 13px; backface-visibility: hidden; display: flex; align-items: center; justify-content: center; }
        .memory-card-front { background: linear-gradient(135deg, rgba(255,107,138,0.14), rgba(255,107,138,0.04)); border: 2px solid rgba(255,107,138,0.24); transform: rotateY(0deg); font-size: 26px; }
        .memory-card-front-icon { opacity: 0.45; animation: cardHover 2.2s ease-in-out infinite; }
        @keyframes cardHover { 0%,100% { transform: scale(1); } 50% { transform: scale(1.12); } }
        .memory-card-back { background: linear-gradient(135deg, rgba(255,255,255,0.08), rgba(255,255,255,0.03)); border: 2px solid rgba(255,107,138,0.4); transform: rotateY(180deg); font-size: 32px; }
        .memory-card.matched .memory-card-back { border-color: var(--gold); background: linear-gradient(135deg, rgba(255,215,0,0.13), rgba(255,215,0,0.04)); box-shadow: 0 0 20px rgba(255,215,0,0.32); animation: matchedPop 0.4s ease; }
        @keyframes matchedPop { 0% { transform: rotateY(180deg) scale(1); } 50% { transform: rotateY(180deg) scale(1.15); } 100% { transform: rotateY(180deg) scale(1); } }
        .memory-stats { display: flex; gap: 25px; margin-top: 25px; }
        .memory-stat { text-align: center; background: rgba(255,255,255,0.04); border: 1px solid rgba(255,107,138,0.2); border-radius: 14px; padding: 15px 28px; }
        .memory-stat-num { font-family: 'Great Vibes', cursive; font-size: 34px; color: var(--pink); }
        .memory-stat-label { font-size: 10px; color: rgba(255,255,255,0.42); letter-spacing: 2px; text-transform: uppercase; }
        .memory-win { text-align: center; display: none; }
        .memory-win.show { display: block; animation: fadeInUp 1s ease; }
        .memory-win-text { font-family: 'Great Vibes', cursive; font-size: 46px; background: linear-gradient(135deg, var(--pink), var(--gold)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; margin-bottom: 15px; }
        .memory-win p { font-family: 'Cormorant Garamond', serif; font-size: 19px; color: rgba(255,255,255,0.75); line-height: 1.85; max-width: 440px; }
        .memory-restart-btn { margin-top: 22px; padding: 13px 42px; background: linear-gradient(135deg, var(--pink), var(--deep-pink)); color: #fff; border: none; border-radius: 50px; font-family: 'Montserrat', sans-serif; font-size: 14px; cursor: pointer; transition: transform 0.3s, box-shadow 0.3s; }
        .memory-restart-btn:hover { transform: scale(1.09); box-shadow: 0 0 32px rgba(255,107,138,0.55); }

        /* ===== QUIZ ===== */
        #puzzle { background: radial-gradient(ellipse at 50% 50%, rgba(255,107,138,0.05), transparent 55%); }
        .puzzle-container { text-align: center; }
        .puzzle-question { font-family: 'Cormorant Garamond', serif; font-size: 24px; color: rgba(255,255,255,0.87); margin-bottom: 32px; max-width: 510px; line-height: 1.65; }
        .puzzle-options { display: flex; flex-wrap: wrap; gap: 13px; justify-content: center; max-width: 510px; }
        .puzzle-btn { padding: 14px 30px; background: rgba(255,255,255,0.055); border: 2px solid rgba(255,107,138,0.25); border-radius: 50px; color: #fff; font-family: 'Montserrat', sans-serif; font-size: 14px; cursor: pointer; transition: all 0.3s; }
        .puzzle-btn:hover { border-color: var(--pink); background: rgba(255,107,138,0.15); transform: scale(1.06); box-shadow: 0 0 20px rgba(255,107,138,0.22); }
        .puzzle-btn.correct { border-color: #4caf50; background: rgba(76,175,80,0.2); animation: popAnim 0.5s; }
        .puzzle-btn.wrong   { border-color: #f44336; background: rgba(244,67,54,0.2);  animation: shake 0.5s; }
        @keyframes shake   { 0%,100% { transform: translateX(0); } 25% { transform: translateX(-10px); } 75% { transform: translateX(10px); } }
        @keyframes popAnim { 0%,100% { transform: scale(1); } 50% { transform: scale(1.1); } }
        .puzzle-progress { display: flex; gap: 9px; justify-content: center; margin-bottom: 35px; }
        .progress-dot { width: 13px; height: 13px; border-radius: 50%; background: rgba(255,255,255,0.14); transition: all 0.3s; }
        .progress-dot.active    { background: var(--pink); box-shadow: 0 0 10px var(--pink); }
        .progress-dot.completed { background: var(--gold);  box-shadow: 0 0 10px var(--gold); }
        .puzzle-reward { display: none; text-align: center; }
        .puzzle-reward.show { display: block; animation: fadeInUp 1s ease; }
        .puzzle-reward-text { font-family: 'Great Vibes', cursive; font-size: 46px; background: linear-gradient(135deg, var(--pink), var(--gold)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; margin-bottom: 22px; }
        .puzzle-reward p { font-family: 'Cormorant Garamond', serif; font-size: 20px; color: rgba(255,255,255,0.77); line-height: 1.9; max-width: 510px; }

        /* ===== WISHES ===== */
        #wishes { background: radial-gradient(ellipse at 50% 50%, rgba(255,215,0,0.04), transparent 55%); }
        .wishes-container { display: flex; flex-wrap: wrap; gap: 18px; justify-content: center; max-width: 820px; }
        .wish-card { background: linear-gradient(135deg, rgba(255,107,138,0.1), rgba(255,215,0,0.04)); border: 1px solid rgba(255,107,138,0.18); border-radius: 18px; padding: 25px; width: 220px; text-align: center; opacity: 0; transform: scale(0.72) translateY(30px); transition: all 0.7s cubic-bezier(0.16,1,0.3,1); }
        .wish-card.visible { opacity: 1; transform: scale(1) translateY(0); }
        .wish-card:hover { transform: scale(1.07) translateY(-5px); border-color: var(--gold); box-shadow: 0 14px 48px rgba(255,215,0,0.14); }
        .wish-icon { font-size: 42px; margin-bottom: 10px; }
        .wish-text { font-family: 'Cormorant Garamond', serif; font-size: 16px; color: rgba(255,255,255,0.76); line-height: 1.65; }

        /* ===== FINAL ===== */
        #final { background: radial-gradient(ellipse at 50% 40%, rgba(255,23,68,0.08), transparent 60%); }
        .final-heart { font-size: 150px; animation: heartbeatMain 1.8s infinite; filter: drop-shadow(0 0 60px rgba(255,23,68,0.72)); margin-bottom: 30px; }
        .final-text { font-family: 'Great Vibes', cursive; font-size: clamp(40px, 9vw, 80px); background: linear-gradient(135deg, var(--pink), var(--gold), var(--rose), var(--pink)); background-size: 300%; -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; animation: gradientShift 3s ease infinite; text-align: center; margin-bottom: 18px; }
        .final-sub { font-family: 'Cormorant Garamond', serif; font-size: 22px; color: rgba(255,255,255,0.62); text-align: center; font-style: italic; max-width: 500px; line-height: 1.75; }
        .envelope { margin-top: 40px; font-size: 85px; cursor: pointer; transition: transform 0.3s, filter 0.3s; animation: floatAnim 3.2s ease-in-out infinite; filter: drop-shadow(0 0 20px rgba(255,107,138,0.32)); }
        .envelope:hover { transform: scale(1.22); filter: drop-shadow(0 0 40px rgba(255,107,138,0.65)); }
        @keyframes floatAnim { 0%,100% { transform: translateY(0); } 50% { transform: translateY(-18px); } }
        .secret-message { max-width: 500px; text-align: center; margin-top: 30px; padding: 32px; background: rgba(255,255,255,0.04); border: 1px solid rgba(255,215,0,0.24); border-radius: 20px; display: none; box-shadow: 0 20px 60px rgba(0,0,0,0.22); }
        .secret-message.show { display: block; animation: fadeInUp 1s ease; }
        .secret-message p { font-family: 'Cormorant Garamond', serif; font-size: 19px; color: rgba(255,255,255,0.84); line-height: 1.95; }

        /* ===== EFFECTS ===== */
        .firework { position: fixed; pointer-events: none; z-index: 9998; }
        .firework-particle { position: absolute; border-radius: 50%; animation: fireworkExplode 1.6s ease-out forwards; }
        @keyframes fireworkExplode { 0% { transform: translate(0,0) scale(1); opacity: 1; } 100% { transform: translate(var(--x),var(--y)) scale(0); opacity: 0; } }
        .confetti-piece { position: fixed; z-index: 9997; pointer-events: none; animation: confettiFall linear forwards; }
        @keyframes confettiFall { 0% { transform: translateY(-10px) rotateZ(0deg) rotateY(0deg); opacity: 1; } 100% { transform: translateY(110vh) rotateZ(800deg) rotateY(720deg); opacity: 0; } }

        /* ===== MUSIC BUTTON ===== */
        .music-toggle { position: fixed; bottom: 26px; right: 26px; width: 52px; height: 52px; border-radius: 50%; background: rgba(255,107,138,0.14); border: 2px solid var(--pink); color: #fff; cursor: pointer; z-index: 1200; display: flex; align-items: center; justify-content: center; transition: all 0.3s; backdrop-filter: blur(16px); box-shadow: 0 0 20px rgba(255,107,138,0.22); }
        .music-toggle:hover { background: var(--pink); transform: scale(1.14); box-shadow: 0 0 40px rgba(255,107,138,0.55); }
        .music-bars { display: flex; align-items: flex-end; gap: 3px; height: 20px; }
        .music-bar { width: 3px; background: #fff; border-radius: 2px; animation: musicPulse 0.72s ease-in-out infinite; }
        .music-bar:nth-child(1) { height: 8px;  animation-delay: 0s; }
        .music-bar:nth-child(2) { height: 14px; animation-delay: 0.13s; }
        .music-bar:nth-child(3) { height: 9px;  animation-delay: 0.26s; }
        .music-bar:nth-child(4) { height: 16px; animation-delay: 0.39s; }
        .music-toggle.paused .music-bar { animation: none; height: 3px !important; }
        @keyframes musicPulse { 0%,100% { height: 4px; } 50% { height: 18px; } }

        /* ===== UTILITY ===== */
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }

        /* ===== RESPONSIVE ‚Äî TABLETS (max 900px) ===== */
        @media (max-width: 900px) {
            section { padding: 70px 18px 70px; }
            .reasons-grid { grid-template-columns: repeat(2, 1fr); gap: 16px; max-width: 600px; }
            .wishes-container { gap: 14px; }
            .wish-card { width: 200px; padding: 20px; }
            .memory-grid { max-width: 400px; gap: 10px; }
            .letter-container { padding: 50px 36px; }
            .timeline { max-width: 520px; }
            #slideNext { right: 74px; }
        }

        /* ===== RESPONSIVE ‚Äî MOBILE (max 680px) ===== */
        @media (max-width: 680px) {
            /* --- NAV: hidden on mobile --- */
            nav { display: none !important; }

            /* --- SECTIONS: scrollable from top --- */
            section {
                padding: 24px 14px 90px;
                justify-content: flex-start;
            }
            /* Short-content slides: auto-center vertically via spacers */
            #hero .hero-content,
            #declaration .declaration-container,
            #final .final-heart { margin-top: auto; }
            #hero .next-hint,
            #declaration .love-messages,
            #final .secret-message,
            #final .envelope { margin-bottom: auto; }
            /* For final: if envelope not last visible, put spacer */
            #final { padding-bottom: 30px; }

            /* --- SLIDE ARROWS: compact bottom bar --- */
            .slide-arrow {
                width: 36px; height: 36px; font-size: 17px;
                top: auto; bottom: 14px; transform: none;
            }
            .slide-arrow:hover { transform: scale(1.08); }
            #slidePrev { left: 10px; }
            #slideNext { right: 10px; }

            /* --- SLIDE DOTS --- */
            #slideDots { bottom: 20px; }
            .slide-dot { width: 6px; height: 6px; }
            .slide-dot.active { width: 18px; }

            /* --- SLIDE COUNTER --- */
            #slideCounter { bottom: 6px; right: auto; left: 50%; transform: translateX(-50%); font-size: 9px; }

            /* --- PRELOADER --- */
            .preloader-heart { font-size: 70px; }
            .preloader-text { font-size: 30px; }
            .preloader-sub { font-size: 11px; letter-spacing: 3px; }
            .enter-btn { padding: 14px 40px; font-size: 15px; margin-top: 36px; }

            /* --- HERO --- */
            .big-heart { font-size: 80px; }
            .big-heart-container { margin-bottom: 16px; }
            .heart-ring:nth-child(1) { width: 120px; height: 120px; }
            .heart-ring:nth-child(2) { width: 152px; height: 152px; }
            .heart-ring:nth-child(3) { width: 188px; height: 188px; }
            .hero-date { font-size: 11px; letter-spacing: 5px; margin-bottom: 14px; }
            .hero-subtitle { font-size: 15px; line-height: 1.7; max-width: 340px; }
            .next-hint { margin-top: 20px; font-size: 24px; }

            /* --- DECLARATION --- */
            .declaration-title { font-size: clamp(24px, 5vw, 38px); }
            .declaration-heart-btn { font-size: 105px; }
            .decl-ring:nth-child(1) { width: 135px; height: 135px; }
            .decl-ring:nth-child(2) { width: 175px; height: 175px; }
            .decl-ring:nth-child(3) { width: 215px; height: 215px; }
            .declaration-sub { font-size: 16px; max-width: 340px; line-height: 1.7; }
            .declaration-hint { font-size: 11px; }
            .love-msg-text { font-size: 20px; }

            /* --- LETTER --- */
            .letter-container {
                padding: 42px 20px;
                border-radius: 20px;
                max-width: 95vw;
            }
            .letter-container::before { font-size: 40px; top: -28px; }
            .letter-title { font-size: 34px; margin-bottom: 20px; }
            .letter-text { font-size: 16px; line-height: 1.9; }
            .letter-signature { font-size: 26px; margin-top: 20px; }

            /* --- REASONS --- */
            .section-title { font-size: clamp(30px, 7vw, 48px); margin-bottom: 30px; }
            .reasons-grid { grid-template-columns: 1fr 1fr; gap: 12px; max-width: 100%; }
            .reason-card { padding: 22px 16px; border-radius: 16px; }
            .reason-icon { font-size: 38px; margin-bottom: 10px; }
            .reason-title { font-size: 17px; margin-bottom: 6px; }
            .reason-desc { font-size: 12px; line-height: 1.55; }

            /* --- TIMELINE --- */
            .timeline { max-width: 100%; }
            .timeline::before { left: 14px; }
            .timeline-dot { left: 14px; width: 11px; height: 11px; }
            .timeline-item { padding: 8px 0; }
            .timeline-content {
                width: calc(100% - 40px) !important;
                margin-left: 40px !important;
                padding: 12px;
            }
            .timeline-emoji { font-size: 20px; margin-bottom: 3px; }
            .timeline-label { font-size: 18px; }
            .timeline-desc { font-size: 11px; margin-top: 3px; }
            #timeline .section-title { margin-bottom: 16px; }

            /* --- MEMORY GAME --- */
            .memory-grid { max-width: 280px; gap: 8px; }
            .memory-card-front { font-size: 20px; }
            .memory-card-back { font-size: 24px; }
            .memory-stats { flex-direction: row; gap: 14px; }
            .memory-stat { padding: 10px 20px; }
            .memory-stat-num { font-size: 26px; }
            .memory-stat-label { font-size: 9px; }
            .memory-win-text { font-size: 34px; }
            .memory-win p { font-size: 16px; }
            .memory-restart-btn { font-size: 13px; padding: 11px 34px; }

            /* --- QUIZ --- */
            .puzzle-question { font-size: 20px; margin-bottom: 24px; max-width: 340px; }
            .puzzle-options { gap: 10px; max-width: 340px; }
            .puzzle-btn { padding: 12px 22px; font-size: 13px; }
            .puzzle-reward-text { font-size: 34px; }
            .puzzle-reward p { font-size: 17px; max-width: 340px; }

            /* --- WISHES --- */
            .wishes-container { gap: 12px; }
            .wish-card { width: calc(50% - 8px); padding: 18px 14px; border-radius: 14px; }
            .wish-icon { font-size: 32px; margin-bottom: 8px; }
            .wish-text { font-size: 14px; line-height: 1.55; }

            /* --- FINAL --- */
            .final-heart { font-size: 100px; margin-bottom: 20px; }
            .final-sub { font-size: 18px; max-width: 340px; }
            .envelope { font-size: 65px; margin-top: 28px; }
            .secret-message { max-width: 90vw; padding: 24px 18px; margin-top: 22px; }
            .secret-message p { font-size: 16px; line-height: 1.8; }

            /* --- MUSIC BUTTON --- */
            .music-toggle {
                width: 44px; height: 44px;
                bottom: 10px; right: 10px;
            }
        }

        /* ===== RESPONSIVE ‚Äî SMALL PHONES (max 400px) ===== */
        @media (max-width: 400px) {
            section { padding: 20px 10px 80px; }

            .preloader-heart { font-size: 58px; }
            .preloader-text { font-size: 26px; }
            .enter-btn { padding: 12px 32px; font-size: 14px; }

            .big-heart { font-size: 64px; }
            .heart-ring:nth-child(1) { width: 95px; height: 95px; }
            .heart-ring:nth-child(2) { width: 120px; height: 120px; }
            .heart-ring:nth-child(3) { width: 148px; height: 148px; }
            .hero-date { font-size: 10px; letter-spacing: 4px; }
            .hero-subtitle { font-size: 14px; max-width: 280px; }

            .declaration-heart-btn { font-size: 85px; }
            .decl-ring:nth-child(1) { width: 110px; height: 110px; }
            .decl-ring:nth-child(2) { width: 145px; height: 145px; }
            .decl-ring:nth-child(3) { width: 180px; height: 180px; }
            .declaration-sub { font-size: 14px; max-width: 280px; }

            .letter-container { padding: 34px 16px; }
            .letter-title { font-size: 28px; }
            .letter-text { font-size: 14px; line-height: 1.85; }
            .letter-signature { font-size: 22px; }

            .reasons-grid { grid-template-columns: 1fr; gap: 10px; }
            .reason-card { padding: 18px 14px; }
            .reason-icon { font-size: 34px; }
            .reason-title { font-size: 16px; }

            .timeline-item { padding: 6px 0; }
            .timeline-content { padding: 10px !important; }
            .timeline-emoji { font-size: 18px; }
            .timeline-label { font-size: 16px; }
            .timeline-desc { font-size: 10px; }
            #timeline .section-title { margin-bottom: 12px; }

            .memory-grid { max-width: 240px; gap: 6px; }
            .memory-card-front { font-size: 16px; }
            .memory-card-back { font-size: 20px; }

            .puzzle-question { font-size: 17px; max-width: 290px; }
            .puzzle-btn { padding: 10px 18px; font-size: 12px; width: calc(50% - 6px); }

            .wish-card { width: 100%; }

            .final-heart { font-size: 78px; }
            .final-sub { font-size: 16px; max-width: 280px; }
            .envelope { font-size: 55px; }

            .slide-arrow { width: 34px; height: 34px; font-size: 16px; }
        }

        /* ===== LANDSCAPE MOBILE ===== */
        @media (max-height: 500px) and (orientation: landscape) {
            nav { display: none !important; }
            section { padding: 16px 20px 60px; justify-content: flex-start; }
            .big-heart { font-size: 55px; }
            .hero-title { font-size: clamp(32px, 6vw, 50px); }
            .hero-subtitle { font-size: 13px; }
            .declaration-heart-btn { font-size: 70px; }
            .decl-ring:nth-child(1) { width: 90px; height: 90px; }
            .decl-ring:nth-child(2) { width: 115px; height: 115px; }
            .decl-ring:nth-child(3) { width: 140px; height: 140px; }
            .letter-container { padding: 30px 20px; }
            .letter-title { font-size: 28px; }
            .letter-text { font-size: 14px; }
            .section-title { font-size: 30px; margin-bottom: 18px; }
            .reasons-grid { grid-template-columns: repeat(3, 1fr); gap: 10px; }
            .reason-card { padding: 14px 10px; }
            .reason-icon { font-size: 28px; }
            .reason-title { font-size: 14px; }
            .reason-desc { font-size: 11px; }
            .memory-grid { max-width: 320px; gap: 6px; }
            .final-heart { font-size: 60px; margin-bottom: 10px; }
            .final-sub { font-size: 14px; }
            .envelope { font-size: 45px; margin-top: 14px; }
            .wish-card { width: 160px; padding: 14px 10px; }
            .wish-icon { font-size: 28px; }
            .wish-text { font-size: 13px; }

            .slide-arrow { bottom: 12px; }
            #slideDots { bottom: 16px; }
            #slideCounter { bottom: 4px; }
        }

        /* ===== SAFE AREA (NOTCH) ===== */
        @supports (padding-top: env(safe-area-inset-top)) {
            nav { padding-top: max(8px, env(safe-area-inset-top)); }
            .music-toggle { bottom: max(10px, env(safe-area-inset-bottom)); right: max(10px, env(safe-area-inset-right)); }
            .slide-arrow#slidePrev { left: max(12px, env(safe-area-inset-left)); }
            .slide-arrow#slideNext { right: max(12px, env(safe-area-inset-right)); }
        }
    </style>
</head>
<body>

<canvas id="starfield"></canvas>

<!-- PRELOADER -->
<div id="preloader">
    <div class="preloader-heart">üíñ</div>
    <div class="preloader-text">–ó–∞–≥—Ä—É–∂–∞—é –ª—é–±–æ–≤—å...</div>
    <div class="preloader-sub">–°–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è —Ç–µ–±—è</div>
    <button class="enter-btn" onclick="enterSite()">–û—Ç–∫—Ä—ã—Ç—å —Å –ª—é–±–æ–≤—å—é üíï</button>
</div>

<!-- NAV -->
<nav id="navbar">
    <a onclick="goToSlide(0)">–ù–∞—á–∞–ª–æ</a>
    <a onclick="goToSlide(1)">–ü—Ä–∏–∑–Ω–∞–Ω–∏–µ</a>
    <a onclick="goToSlide(2)">–ü–∏—Å—å–º–æ</a>
    <a onclick="goToSlide(3)">–ü–æ—á–µ–º—É —Ç—ã</a>
    <a onclick="goToSlide(4)">–ú–æ–º–µ–Ω—Ç—ã</a>
    <a onclick="goToSlide(5)">–ü–∞—Ä—ã</a>
    <a onclick="goToSlide(6)">–í–∏–∫—Ç–æ—Ä–∏–Ω–∞</a>
    <a onclick="goToSlide(7)">–ü–æ–∂–µ–ª–∞–Ω–∏—è</a>
    <a onclick="goToSlide(8)">–§–∏–Ω–∞–ª</a>
</nav>

<!-- FLOATING HEARTS -->
<div id="hearts-bg"></div>

<!-- ========== SLIDES ========== -->
<div id="slides-wrap">

    <!-- 0: HERO -->
    <section id="hero">
        <div class="hero-content" id="heroContent">
            <div class="big-heart-container">
                <div class="heart-rings">
                    <div class="heart-ring"></div>
                    <div class="heart-ring"></div>
                    <div class="heart-ring"></div>
                </div>
                <div class="big-heart" onclick="heartClick(this)">‚ù§Ô∏è</div>
            </div>
            <div class="hero-date">14 —Ñ–µ–≤—Ä–∞–ª—è 2026</div>
            <h1 class="hero-title">–° –î–Ω—ë–º –°–≤—è—Ç–æ–≥–æ –í–∞–ª–µ–Ω—Ç–∏–Ω–∞</h1>
            <p class="hero-subtitle">–ö–∞–∂–¥—ã–π –¥–µ–Ω—å —Ä—è–¥–æ–º —Å —Ç–æ–±–æ–π ‚Äî —ç—Ç–æ –ø—Ä–∞–∑–¥–Ω–∏–∫. –ù–æ —Å–µ–≥–æ–¥–Ω—è –æ—Å–æ–±–µ–Ω–Ω—ã–π –¥–µ–Ω—å, —á—Ç–æ–±—ã —Å–∫–∞–∑–∞—Ç—å —Ç–µ–±–µ, –∫–∞–∫ —Å–∏–ª—å–Ω–æ —è —Ç–µ–±—è –ª—é–±–ª—é...</p>
        </div>
        <div class="next-hint" onclick="changeSlide(1)">üíù</div>
    </section>

    <!-- 1: DECLARATION -->
    <section id="declaration">
        <div class="declaration-container">
            <div class="declaration-title">–ú–æ—ë —Å–µ—Ä–¥—Ü–µ –±—å—ë—Ç—Å—è –¥–ª—è —Ç–µ–±—è</div>
            <div class="declaration-heart-wrap">
                <div class="decl-rings">
                    <div class="decl-ring"></div>
                    <div class="decl-ring"></div>
                    <div class="decl-ring"></div>
                </div>
                <div class="declaration-heart-btn" id="declHeart" onclick="declareL()">‚ù§Ô∏è</div>
            </div>
            <div class="declaration-sub">
                –¢—ã ‚Äî —Å–∞–º–æ–µ –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ–µ, —á—Ç–æ –µ—Å—Ç—å –≤ –º–æ–µ–π –∂–∏–∑–Ω–∏.<br>
                –° —Ç–æ–±–æ–π –∫–∞–∂–¥—ã–π –º–æ–º–µ–Ω—Ç —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–µ–∑–∞–±—ã–≤–∞–µ–º—ã–º.
            </div>
            <div class="declaration-hint">‚Üë –ù–∞–∂–º–∏ –Ω–∞ —Å–µ—Ä–¥—Ü–µ ‚Üë</div>
            <div class="love-messages" id="loveMessages"></div>
        </div>
    </section>

    <!-- 2: LETTER -->
    <section id="letter">
        <div class="letter-container" id="letterBox">
            <h2 class="letter-title">–ú–æ—ë –ø–∏—Å—å–º–æ —Ç–µ–±–µ</h2>
            <p class="letter-text" id="letterText"></p>
            <div class="letter-signature">–ù–∞–≤—Å–µ–≥–¥–∞ —Ç–≤–æ–π ‚ù§Ô∏è</div>
        </div>
    </section>

    <!-- 3: REASONS -->
    <section id="reasons">
        <h2 class="section-title">–ó–∞ —á—Ç–æ —è —Ç–µ–±—è –ª—é–±–ª—é</h2>
        <div class="reasons-grid">
            <div class="reason-card"><div class="reason-icon">‚ú®</div><div class="reason-title">–¢–≤–æ—è —É–ª—ã–±–∫–∞</div><div class="reason-desc">–û–Ω–∞ –æ—Å–≤–µ—â–∞–µ—Ç –¥–∞–∂–µ —Å–∞–º—ã–µ —Ç—ë–º–Ω—ã–µ –¥–Ω–∏ –∏ –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç –º–æ—ë —Å–µ—Ä–¥—Ü–µ —Ç–∞—è—Ç—å</div></div>
            <div class="reason-card"><div class="reason-icon">üå∏</div><div class="reason-title">–¢–≤–æ—è –Ω–µ–∂–Ω–æ—Å—Ç—å</div><div class="reason-desc">–¢—ã —Å–∞–º—ã–π –¥–æ–±—Ä—ã–π –∏ –∑–∞–±–æ—Ç–ª–∏–≤—ã–π —á–µ–ª–æ–≤–µ–∫, –∫–æ—Ç–æ—Ä–æ–≥–æ —è –∫–æ–≥–¥–∞-–ª–∏–±–æ –≤—Å—Ç—Ä–µ—á–∞–ª</div></div>
            <div class="reason-card"><div class="reason-icon">üî•</div><div class="reason-title">–¢–≤–æ—è —Å—Ç—Ä–∞—Å—Ç—å</div><div class="reason-desc">–¢—ã –≤–¥–æ—Ö–Ω–æ–≤–ª—è–µ—à—å –º–µ–Ω—è –±—ã—Ç—å –ª—É—á—à–µ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å</div></div>
            <div class="reason-card"><div class="reason-icon">üíé</div><div class="reason-title">–¢–≤–æ—è –∫—Ä–∞—Å–æ—Ç–∞</div><div class="reason-desc">–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –∏ –≤–Ω–µ—à–Ω—è—è ‚Äî —Ç—ã –ø—Ä–µ–∫—Ä–∞—Å–Ω–∞ –≤–æ –≤—Å—ë–º</div></div>
            <div class="reason-card"><div class="reason-icon">üéµ</div><div class="reason-title">–¢–≤–æ–π —Å–º–µ—Ö</div><div class="reason-desc">–°–∞–º–∞—è –∫—Ä–∞—Å–∏–≤–∞—è –º–µ–ª–æ–¥–∏—è, –∫–æ—Ç–æ—Ä—É—é —è –∫–æ–≥–¥–∞-–ª–∏–±–æ —Å–ª—ã—à–∞–ª</div></div>
            <div class="reason-card"><div class="reason-icon">üåô</div><div class="reason-title">–¢–≤–æ—ë —Ç–µ–ø–ª–æ</div><div class="reason-desc">–†—è–¥–æ–º —Å —Ç–æ–±–æ–π —è —á—É–≤—Å—Ç–≤—É—é —Å–µ–±—è –¥–æ–º–∞, –≥–¥–µ –±—ã –º—ã –Ω–∏ –±—ã–ª–∏</div></div>
        </div>
    </section>

    <!-- 4: TIMELINE -->
    <section id="timeline">
        <h2 class="section-title">–ù–∞—à–∏ –º–æ–º–µ–Ω—Ç—ã</h2>
        <div class="timeline">
            <div class="timeline-item"><div class="timeline-dot"></div><div class="timeline-content"><div class="timeline-emoji">ü¶ã</div><div class="timeline-label">–ü–µ—Ä–≤–∞—è –≤—Å—Ç—Ä–µ—á–∞</div><div class="timeline-desc">–ú–æ–º–µ–Ω—Ç, –∫–æ–≥–¥–∞ –º–æ—è –∂–∏–∑–Ω—å –∏–∑–º–µ–Ω–∏–ª–∞—Å—å –Ω–∞–≤—Å–µ–≥–¥–∞</div></div></div>
            <div class="timeline-item"><div class="timeline-dot"></div><div class="timeline-content"><div class="timeline-emoji">üíò</div><div class="timeline-label">–ü–µ—Ä–≤–æ–µ —Å–≤–∏–¥–∞–Ω–∏–µ</div><div class="timeline-desc">–ë–∞–±–æ—á–∫–∏ –≤ –∂–∏–≤–æ—Ç–µ –∏ –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–µ —Ä–∞–∑–≥–æ–≤–æ—Ä—ã</div></div></div>
            <div class="timeline-item"><div class="timeline-dot"></div><div class="timeline-content"><div class="timeline-emoji">üíë</div><div class="timeline-label">–ü–µ—Ä–≤—ã–π –ø–æ—Ü–µ–ª—É–π</div><div class="timeline-desc">–í—Ä–µ–º—è –æ—Å—Ç–∞–Ω–æ–≤–∏–ª–æ—Å—å, –∞ –º–∏—Ä –≤–æ–∫—Ä—É–≥ –∏—Å—á–µ–∑</div></div></div>
            <div class="timeline-item"><div class="timeline-dot"></div><div class="timeline-content"><div class="timeline-emoji">üíû</div><div class="timeline-label">–ö–∞–∂–¥—ã–π –¥–µ–Ω—å</div><div class="timeline-desc">–° –∫–∞–∂–¥—ã–º –¥–Ω—ë–º —è –ª—é–±–ª—é —Ç–µ–±—è –≤—Å—ë —Å–∏–ª—å–Ω–µ–µ</div></div></div>
            <div class="timeline-item"><div class="timeline-dot"></div><div class="timeline-content"><div class="timeline-emoji">‚ôæÔ∏è</div><div class="timeline-label">–ù–∞–≤—Å–µ–≥–¥–∞</div><div class="timeline-desc">–≠—Ç–æ —Ç–æ–ª—å–∫–æ –Ω–∞—á–∞–ª–æ –Ω–∞—à–µ–π –∏—Å—Ç–æ—Ä–∏–∏...</div></div></div>
        </div>
    </section>

    <!-- 5: MEMORY GAME -->
    <section id="memory">
        <div class="memory-intro">
            <h2 class="section-title">–ù–∞–π–¥–∏ –ø–∞—Ä—ã —Å–µ—Ä–¥–µ—Ü</h2>
            <p>–ü–µ—Ä–µ–≤–æ—Ä–∞—á–∏–≤–∞–π –∫–∞—Ä—Ç–æ—á–∫–∏ –∏ –Ω–∞—Ö–æ–¥–∏ –ø–∞—Ä—ã ‚Äî –∫–∞–∫ –º—ã –Ω–∞—à–ª–∏ –¥—Ä—É–≥ –¥—Ä—É–≥–∞ üíï</p>
        </div>
        <div class="memory-grid" id="memoryGrid"></div>
        <div class="memory-stats">
            <div class="memory-stat"><div class="memory-stat-num" id="memMoves">0</div><div class="memory-stat-label">–•–æ–¥–æ–≤</div></div>
            <div class="memory-stat"><div class="memory-stat-num" id="memPairs">0/8</div><div class="memory-stat-label">–ü–∞—Ä</div></div>
        </div>
        <div class="memory-win" id="memoryWin">
            <div class="memory-win-text">–¢—ã –Ω–∞—à–ª–∞ –≤—Å–µ –ø–∞—Ä—ã! üéâ</div>
            <p>–°–æ–≤—Å–µ–º –∫–∞–∫ –≤ –∂–∏–∑–Ω–∏ ‚Äî –º—ã –Ω–∞—à–ª–∏ –¥—Ä—É–≥ –¥—Ä—É–≥–∞ —Å—Ä–µ–¥–∏ –º–∏–ª–ª–∏–∞—Ä–¥–æ–≤ –ª—é–¥–µ–π. –≠—Ç–æ —Å—É–¥—å–±–∞! üíï</p>
            <button class="memory-restart-btn" onclick="initMemoryGame()">–ò–≥—Ä–∞—Ç—å –µ—â—ë üíñ</button>
        </div>
    </section>

    <!-- 6: QUIZ -->
    <section id="puzzle">
        <h2 class="section-title">–í–∏–∫—Ç–æ—Ä–∏–Ω–∞ –ª—é–±–≤–∏</h2>
        <div class="puzzle-container" id="puzzleContainer">
            <div class="puzzle-progress" id="puzzleProgress"></div>
            <div class="puzzle-question" id="puzzleQuestion"></div>
            <div class="puzzle-options" id="puzzleOptions"></div>
        </div>
        <div class="puzzle-reward" id="puzzleReward">
            <div class="puzzle-reward-text">–¢—ã –ø—Ä–æ—à–ª–∞ –≤–∏–∫—Ç–æ—Ä–∏–Ω—É! üéâ</div>
            <p>–ö–∞–∂–¥—ã–π –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç ‚Äî –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ —Ç–æ–≥–æ, —á—Ç–æ –º—ã —Å–æ–∑–¥–∞–Ω—ã –¥—Ä—É–≥ –¥–ª—è –¥—Ä—É–≥–∞! üíï</p>
        </div>
    </section>

    <!-- 8: WISHES -->
    <section id="wishes">
        <h2 class="section-title">–ú–æ–∏ –ø–æ–∂–µ–ª–∞–Ω–∏—è —Ç–µ–±–µ</h2>
        <div class="wishes-container">
            <div class="wish-card"><div class="wish-icon">üåü</div><div class="wish-text">–ß—Ç–æ–±—ã –∫–∞–∂–¥—ã–π —Ç–≤–æ–π –¥–µ–Ω—å –Ω–∞—á–∏–Ω–∞–ª—Å—è —Å —É–ª—ã–±–∫–∏</div></div>
            <div class="wish-card"><div class="wish-icon">üåà</div><div class="wish-text">–ß—Ç–æ–±—ã —Ç–≤–æ–∏ –º–µ—á—Ç—ã —Å–±—ã–≤–∞–ª–∏—Å—å –æ–¥–Ω–∞ –∑–∞ –¥—Ä—É–≥–æ–π</div></div>
            <div class="wish-card"><div class="wish-icon">‚òÄÔ∏è</div><div class="wish-text">–ß—Ç–æ–±—ã —Å–æ–ª–Ω—Ü–µ –≤—Å–µ–≥–¥–∞ —Å–æ–≥—Ä–µ–≤–∞–ª–æ —Ç–≤–æ—é –¥—É—à—É</div></div>
            <div class="wish-card"><div class="wish-icon">ü¶ã</div><div class="wish-text">–ß—Ç–æ–±—ã —Å—á–∞—Å—Ç—å–µ –ª–µ—Ç–µ–ª–æ –∫ —Ç–µ–±–µ —Å–æ –≤—Å–µ—Ö —Å—Ç–æ—Ä–æ–Ω</div></div>
            <div class="wish-card"><div class="wish-icon">üå∫</div><div class="wish-text">–ß—Ç–æ–±—ã –ª—é–±–æ–≤—å –æ–∫—É—Ç—ã–≤–∞–ª–∞ —Ç–µ–±—è –∫–∞–∂–¥—ã–π –º–∏–≥</div></div>
            <div class="wish-card"><div class="wish-icon">üí´</div><div class="wish-text">–ß—Ç–æ–±—ã —Ä—è–¥–æ–º –≤—Å–µ–≥–¥–∞ –±—ã–ª —Ç–æ—Ç, –∫—Ç–æ –ª—é–±–∏—Ç –±–µ–∑–º–µ—Ä–Ω–æ ‚Äî —è üíï</div></div>
        </div>
    </section>

    <!-- 9: FINAL -->
    <section id="final">
        <div class="final-heart">‚ù§Ô∏è</div>
        <h2 class="final-text">–Ø –ª—é–±–ª—é —Ç–µ–±—è</h2>
        <p class="final-sub">–°–µ–≥–æ–¥–Ω—è, –∑–∞–≤—Ç—Ä–∞, –≤—Å–µ–≥–¥–∞ –∏ –Ω–∞–≤—Å–µ–≥–¥–∞...</p>
        <div class="envelope" id="envelope" onclick="openEnvelope()">üíå</div>
        <div class="secret-message" id="secretMsg">
            <p>–¢—ã ‚Äî –º–æ—ë —Å–∞–º–æ–µ –±–æ–ª—å—à–æ–µ —Å—á–∞—Å—Ç—å–µ –∏ —Å–∞–º–æ–µ —Ü–µ–Ω–Ω–æ–µ —Å–æ–∫—Ä–æ–≤–∏—â–µ. –Ø –æ–±–µ—â–∞—é –ª—é–±–∏—Ç—å —Ç–µ–±—è, –∑–∞–±–æ—Ç–∏—Ç—å—Å—è –æ —Ç–µ–±–µ –∏ –¥–µ–ª–∞—Ç—å —Ç–µ–±—è —Å—á–∞—Å—Ç–ª–∏–≤–æ–π –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –Ω–∞—à–µ–π –∂–∏–∑–Ω–∏. üíï<br><br>–° –î–Ω—ë–º –°–≤—è—Ç–æ–≥–æ –í–∞–ª–µ–Ω—Ç–∏–Ω–∞, –º–æ–π –ª—é–±–∏–º—ã–π —á–µ–ª–æ–≤–µ–∫! üåπ</p>
        </div>
    </section>

</div><!-- /slides-wrap -->

<!-- SLIDE NAV -->
<button class="slide-arrow" id="slidePrev" onclick="changeSlide(-1)">&#8249;</button>
<button class="slide-arrow" id="slideNext" onclick="changeSlide(1)">&#8250;</button>
<div id="slideDots"></div>
<div id="slideCounter"></div>

<!-- MUSIC -->
<button class="music-toggle paused" id="musicToggle" onclick="toggleMusic()" title="–ú—É–∑—ã–∫–∞">
    <div class="music-bars">
        <div class="music-bar"></div><div class="music-bar"></div>
        <div class="music-bar"></div><div class="music-bar"></div>
    </div>
</button>

<script>
// ================================================================
// STARFIELD
// ================================================================
const canvas = document.getElementById('starfield');
const ctx    = canvas.getContext('2d');
let stars    = [];
function resizeCanvas() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
function createStars() {
    stars = [];
    const density = window.innerWidth < 680 ? 10000 : 5000;
    const n = Math.floor(canvas.width * canvas.height / density);
    for (let i = 0; i < n; i++) stars.push({ x: Math.random()*canvas.width, y: Math.random()*canvas.height, r: Math.random()*1.5+0.2, phase: Math.random()*Math.PI*2, speed: Math.random()*0.025+0.008, hue: Math.random()>0.85 ? 330+Math.random()*40 : 200+Math.random()*40 });
}
function drawStars() {
    ctx.clearRect(0,0,canvas.width,canvas.height);
    stars.forEach(s => { s.phase+=s.speed; const a=0.25+0.75*Math.abs(Math.sin(s.phase)); ctx.beginPath(); ctx.arc(s.x,s.y,s.r,0,Math.PI*2); ctx.fillStyle=`hsla(${s.hue},90%,90%,${a})`; ctx.fill(); });
    requestAnimationFrame(drawStars);
}
resizeCanvas(); createStars(); requestAnimationFrame(drawStars);
window.addEventListener('resize', ()=>{ resizeCanvas(); createStars(); });

// ================================================================
// PETALS
// ================================================================
function spawnPetal() {
    const p = document.createElement('div'); p.className='petal';
    p.style.left = Math.random()*100+'vw';
    p.style.setProperty('--sway', ((Math.random()-0.5)*220)+'px');
    const sz = 7+Math.random()*9;
    p.style.width=sz+'px'; p.style.height=(sz*1.3)+'px';
    p.style.background=`linear-gradient(135deg,${Math.random()>0.5?'#ff6b8a':'#e91e63'},rgba(255,23,68,0.6))`;
    const dur=9+Math.random()*14; p.style.animationDuration=dur+'s'; p.style.animationDelay=(Math.random()*4)+'s';
    document.body.appendChild(p); setTimeout(()=>p.remove(),(dur+4)*1000);
}
function createPetals() {
    const count = isMobile ? 10 : 22;
    const interval = isMobile ? 2400 : 1400;
    for(let i=0;i<count;i++) setTimeout(spawnPetal,i*250);
    setInterval(spawnPetal,interval);
}

// ================================================================
// AUDIO
// ================================================================
let audioCtx=null, musicPlaying=false;
function createAmbientMusic() {
    if(audioCtx) return;
    audioCtx=new(window.AudioContext||window.webkitAudioContext)();
    const master=audioCtx.createGain(); master.gain.value=0.048; master.connect(audioCtx.destination);
    const delay=audioCtx.createDelay(1.0); delay.delayTime.value=0.42;
    const dg=audioCtx.createGain(); dg.gain.value=0.22; delay.connect(dg); dg.connect(master);
    const scale=[261.63,293.66,329.63,349.23,392,440,493.88,523.25,587.33,659.25];
    function playNote() {
        if(!musicPlaying) return;
        const freq=scale[Math.floor(Math.random()*scale.length)]*(Math.random()>0.3?2:1);
        const osc=audioCtx.createOscillator(), g=audioCtx.createGain();
        osc.type='sine'; osc.frequency.value=freq;
        g.gain.setValueAtTime(0,audioCtx.currentTime); g.gain.linearRampToValueAtTime(0.28,audioCtx.currentTime+0.25); g.gain.linearRampToValueAtTime(0,audioCtx.currentTime+2.2);
        osc.connect(g); g.connect(master); g.connect(delay); osc.start(); osc.stop(audioCtx.currentTime+2.2);
        setTimeout(playNote,450+Math.random()*950);
    }
    function playPad() {
        if(!musicPlaying) return;
        const pf=[130.81,164.81,196,220]; const freq=pf[Math.floor(Math.random()*pf.length)];
        const osc=audioCtx.createOscillator(), g=audioCtx.createGain();
        osc.type='triangle'; osc.frequency.value=freq;
        g.gain.setValueAtTime(0,audioCtx.currentTime); g.gain.linearRampToValueAtTime(0.13,audioCtx.currentTime+1.8); g.gain.linearRampToValueAtTime(0,audioCtx.currentTime+5.5);
        osc.connect(g); g.connect(master); osc.start(); osc.stop(audioCtx.currentTime+5.5);
        setTimeout(playPad,3200+Math.random()*2400);
    }
    playNote(); playPad();
}
function toggleMusic() {
    const btn=document.getElementById('musicToggle');
    if(musicPlaying){ musicPlaying=false; btn.classList.add('paused'); if(audioCtx) audioCtx.suspend(); }
    else { musicPlaying=true; btn.classList.remove('paused'); if(!audioCtx) createAmbientMusic(); else audioCtx.resume(); }
}
function playClickSound(freq=880) {
    if(!audioCtx) return;
    const osc=audioCtx.createOscillator(), g=audioCtx.createGain();
    osc.type='sine'; osc.frequency.value=freq;
    g.gain.setValueAtTime(0.18,audioCtx.currentTime); g.gain.linearRampToValueAtTime(0,audioCtx.currentTime+0.32);
    osc.connect(g); g.connect(audioCtx.destination); osc.start(); osc.stop(audioCtx.currentTime+0.32);
}

// ================================================================
// FLOATING HEARTS
// ================================================================
const isMobile = window.innerWidth < 680;
function createFloatingHearts() {
    const c=document.getElementById('hearts-bg');
    const h=['üíï','üíñ','üíó','üíì','üíò','üíù','‚ô•','‚ù§Ô∏è','üåπ','‚ú®','üí´','üå∏'];
    const interval = isMobile ? 1200 : 680;
    setInterval(()=>{ const el=document.createElement('div'); el.className='floating-heart'; el.textContent=h[Math.floor(Math.random()*h.length)]; el.style.left=Math.random()*100+'%'; el.style.fontSize=(11+Math.random()*(isMobile?16:23))+'px'; el.style.animationDuration=(10+Math.random()*15)+'s'; c.appendChild(el); setTimeout(()=>el.remove(),25000); },interval);
}

// ================================================================
// SPARKLE CURSOR
// ================================================================
// Sparkle cursor (desktop only ‚Äî no hover on touch)
let sparkleT=0;
const hasTouch = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
if (!hasTouch) {
    document.addEventListener('mousemove',e=>{
        if(Date.now()-sparkleT<68) return; sparkleT=Date.now();
        const s=document.createElement('div'); s.className='sparkle';
        s.textContent=['‚ú®','üíï','‚≠ê','üíñ','üå∏','üíó'][Math.floor(Math.random()*6)];
        s.style.left=e.clientX+'px'; s.style.top=e.clientY+'px';
        document.body.appendChild(s); setTimeout(()=>s.remove(),850);
    });
}

// ================================================================
// HEART BURST
// ================================================================
(()=>{ const st=document.createElement('style'); st.textContent=`@keyframes burstFly{0%{transform:translate(0,0) scale(1.2);opacity:1}100%{transform:translate(var(--bx),var(--by)) scale(0.15);opacity:0}}`; document.head.appendChild(st); })();
function launchHeartBurst(el) {
    const r=el.getBoundingClientRect(), cx=r.left+r.width/2, cy=r.top+r.height/2;
    const em=['‚ù§Ô∏è','üíï','üíñ','üíó','üíì','üåπ','‚ú®','üíò'];
    for(let i=0;i<14;i++){
        const b=document.createElement('div');
        const bx=(Math.random()-0.5)*240, by=-65-Math.random()*170;
        b.style.cssText=`position:fixed;left:${cx}px;top:${cy}px;font-size:${14+Math.random()*18}px;pointer-events:none;z-index:9999;--bx:${bx}px;--by:${by}px;animation:burstFly ${0.9+Math.random()*0.5}s ease-out forwards`;
        b.textContent=em[Math.floor(Math.random()*em.length)]; document.body.appendChild(b); setTimeout(()=>b.remove(),1400);
    }
}
function heartClick(el){ launchHeartBurst(el); playClickSound(523); }

// ================================================================
// FIREWORKS & CONFETTI
// ================================================================
function launchFireworks() { for(let i=0;i<5;i++) setTimeout(()=>createFirework(Math.random()*window.innerWidth,Math.random()*window.innerHeight*0.6),i*360); }
function createFirework(x,y) {
    const colors=['#ff6b8a','#ffd700','#ff1744','#e91e63','#ff4081','#ff80ab','#fff','#c5e1a5'];
    const w=document.createElement('div'); w.className='firework'; w.style.left=x+'px'; w.style.top=y+'px';
    for(let i=0;i<26;i++){ const p=document.createElement('div'); p.className='firework-particle'; const a=(i/26)*Math.PI*2, d=55+Math.random()*110; p.style.setProperty('--x',Math.cos(a)*d+'px'); p.style.setProperty('--y',Math.sin(a)*d+'px'); p.style.background=colors[Math.floor(Math.random()*colors.length)]; const sz=3+Math.random()*5; p.style.width=sz+'px'; p.style.height=sz+'px'; w.appendChild(p); }
    document.body.appendChild(w); setTimeout(()=>w.remove(),1700);
}
function launchConfetti() {
    const colors=['#ff6b8a','#ffd700','#ff1744','#e91e63','#ff80ab','#fff','#a5d6a7','#80deea'];
    const count = window.innerWidth < 680 ? 40 : 90;
    for(let i=0;i<count;i++) setTimeout(()=>{ const p=document.createElement('div'); p.className='confetti-piece'; p.style.left=Math.random()*100+'vw'; p.style.background=colors[Math.floor(Math.random()*colors.length)]; p.style.animationDuration=(2.2+Math.random()*3.5)+'s'; const w=5+Math.random()*9; p.style.width=w+'px'; p.style.height=(w*(Math.random()>0.5?1:1.8))+'px'; p.style.borderRadius=Math.random()>0.5?'50%':'2px'; document.body.appendChild(p); setTimeout(()=>p.remove(),6000); },i*22);
}

// ================================================================
// SLIDE ENGINE
// ================================================================
const SLIDE_IDS = ['hero','declaration','letter','reasons','timeline','memory','puzzle','wishes','final'];
let curSlide    = 0;
let slideBusy   = false;
const slideEls  = SLIDE_IDS.map(id => document.getElementById(id));

// Flags for one-time animations
let reasonsDone=false, timelineDone=false, wishesDone=false, letterTyped=false, quizStarted=false;

function initSlides() {
    // First slide visible, rest off-screen right
    slideEls.forEach((s, i) => {
        s.style.transition = 'none';
        s.style.transform  = i === 0 ? 'translateX(0)'    : 'translateX(100%)';
        s.style.opacity    = i === 0 ? '1'                 : '0';
        s.style.pointerEvents = i === 0 ? 'all' : 'none';
    });

    // Build dots
    const dotsWrap = document.getElementById('slideDots');
    SLIDE_IDS.forEach((_, i) => {
        const d = document.createElement('div');
        d.className = 'slide-dot' + (i === 0 ? ' active' : '');
        d.onclick = () => goToSlide(i);
        dotsWrap.appendChild(d);
    });

    // Show nav elements
    ['slidePrev','slideNext','slideDots','slideCounter'].forEach(id => {
        document.getElementById(id).classList.add('ready');
    });

    updateNavUI();
    onSlideEnter(0, -1);
}

function goToSlide(next) {
    if (slideBusy || next === curSlide) return;
    if (next < 0 || next >= slideEls.length) return;
    slideBusy = true;

    const dir    = next > curSlide ? 1 : -1;
    const curEl  = slideEls[curSlide];
    const nextEl = slideEls[next];

    // Place next slide off-screen in the direction it comes from
    nextEl.style.transition   = 'none';
    nextEl.style.transform    = `translateX(${dir * 100}%)`;
    nextEl.style.opacity      = '1';
    nextEl.style.pointerEvents = 'none';
    nextEl.offsetHeight; // force reflow

    // Slide both simultaneously
    const T = 'transform 0.75s cubic-bezier(0.77,0,0.175,1), opacity 0.3s ease';
    nextEl.style.transition = T;
    curEl.style.transition  = T;

    nextEl.style.transform = 'translateX(0)';
    curEl.style.transform  = `translateX(${-dir * 100}%)`;
    curEl.style.opacity    = '0';

    const prev = curSlide;
    curSlide = next;
    updateNavUI();

    setTimeout(() => {
        curEl.style.pointerEvents  = 'none';
        nextEl.style.pointerEvents = 'all';
        slideBusy = false;
        onSlideEnter(next, prev);
    }, 780);
}

function changeSlide(dir) { goToSlide(curSlide + dir); }

function updateNavUI() {
    // Dots
    document.querySelectorAll('.slide-dot').forEach((d, i) => d.classList.toggle('active', i === curSlide));
    // Arrows dim
    document.getElementById('slidePrev').classList.toggle('dim', curSlide === 0);
    document.getElementById('slideNext').classList.toggle('dim', curSlide === slideEls.length - 1);
    // Counter
    document.getElementById('slideCounter').textContent = `${curSlide + 1} / ${slideEls.length}`;
    // Nav active link
    document.querySelectorAll('nav a').forEach((a, i) => a.classList.toggle('cur', i === curSlide));
}

// Called when a new slide becomes active
function onSlideEnter(idx, prev) {
    const id = SLIDE_IDS[idx];

    if (id === 'letter') {
        document.getElementById('letterBox').classList.add('visible');
        if (!letterTyped) { letterTyped = true; typewriteLetter(); }
    }
    if (id === 'reasons' && !reasonsDone) {
        reasonsDone = true;
        document.querySelectorAll('.reason-card').forEach((c, i) => setTimeout(() => c.classList.add('visible'), i * 130));
    }
    if (id === 'timeline' && !timelineDone) {
        timelineDone = true;
        document.querySelectorAll('.timeline-item').forEach((el, i) => setTimeout(() => el.classList.add('visible'), i * 200));
    }
    if (id === 'wishes' && !wishesDone) {
        wishesDone = true;
        document.querySelectorAll('.wish-card').forEach((c, i) => setTimeout(() => c.classList.add('visible'), i * 130));
    }
    if (id === 'puzzle' && !quizStarted) { initQuiz(); }
    if (id === 'final') {
        setTimeout(() => { if (!envelopeOpened) launchFireworks(); }, 600);
    }
}

// Keyboard navigation
document.addEventListener('keydown', e => {
    if (e.key === 'ArrowRight' || e.key === 'ArrowDown')  changeSlide(1);
    if (e.key === 'ArrowLeft'  || e.key === 'ArrowUp')    changeSlide(-1);
});

// Touch swipe (skip inside game areas; only trigger on clearly horizontal swipes)
let txStart = 0, tyStart = 0, swipeBlocked = false;
document.addEventListener('touchstart', e => {
    txStart = e.touches[0].clientX; tyStart = e.touches[0].clientY;
    const t = e.target;
    swipeBlocked = !!(t.closest('.memory-grid') || t.closest('.puzzle-options'));
}, { passive: true });
document.addEventListener('touchend', e => {
    if (swipeBlocked) return;
    const dx = e.changedTouches[0].clientX - txStart;
    const dy = e.changedTouches[0].clientY - tyStart;
    // Only trigger horizontal swipe if clearly horizontal (ratio > 1.5) and long enough
    if (Math.abs(dx) > Math.abs(dy) * 1.5 && Math.abs(dx) > 50) changeSlide(dx > 0 ? -1 : 1);
});

// ================================================================
// ENTER SITE
// ================================================================
function enterSite() {
    document.getElementById('preloader').classList.add('hidden');
    document.getElementById('navbar').classList.add('visible');
    document.getElementById('heroContent').classList.add('visible');
    createFloatingHearts();
    createPetals();
    launchFireworks();
    setTimeout(launchFireworks, 900);
    setTimeout(launchFireworks, 1900);
    initSlides();
}

// ================================================================
// DECLARATION
// ================================================================
const loveMsgs = [
    '–¢—ã ‚Äî —Å–≤–µ—Ç –º–æ–µ–π –∂–∏–∑–Ω–∏ ‚ú®',
    '–Ø –ª—é–±–ª—é —Ç–µ–±—è –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ üíï',
    '–¢—ã –¥–µ–ª–∞–µ—à—å –º–µ–Ω—è —Å—á–∞—Å—Ç–ª–∏–≤—ã–º ü•∞',
    '–ú–æ—ë —Å–µ—Ä–¥—Ü–µ —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ–±—è ‚ù§Ô∏è',
    '–° —Ç–æ–±–æ–π —è –¥–æ–º–∞, –≥–¥–µ –±—ã –º—ã –Ω–∏ –±—ã–ª–∏ üåπ',
    '–¢—ã ‚Äî –ª—É—á—à–µ–µ, —á—Ç–æ —Å–ª—É—á–∏–ª–æ—Å—å –≤ –º–æ–µ–π –∂–∏–∑–Ω–∏ üíñ',
    '–ö–∞–∂–¥—ã–π –º–∏–≥ —Å —Ç–æ–±–æ–π ‚Äî —Å–æ–∫—Ä–æ–≤–∏—â–µ üíé',
    '–¢—ã –º–æ—è –∑–≤–µ–∑–¥–∞, –º–æ–π —Ä–∞—Å—Å–≤–µ—Ç, –º–æ—è –≤—Å–µ–ª–µ–Ω–Ω–∞—è üåü',
    '–†—è–¥–æ–º —Å —Ç–æ–±–æ–π –≤—Ä–µ–º—è –ª–µ—Ç–∏—Ç –Ω–µ–∑–∞–º–µ—Ç–Ω–æ ü¶ã',
    '–¢—ã ‚Äî –º–æ—è –ª—é–±–∏–º–∞—è –∏—Å—Ç–æ—Ä–∏—è –±–µ–∑ –∫–æ–Ω—Ü–∞ üìñüíï',
];
let msgIdx = 0, declCount = 0;
function declareL() {
    declCount++;
    const heart = document.getElementById('declHeart');
    heart.style.animation = 'none'; void heart.offsetHeight; heart.style.animation = '';
    launchHeartBurst(heart); launchFireworks(); playClickSound(659);
    const c = document.getElementById('loveMessages'); c.innerHTML = '';
    const el = document.createElement('div'); el.className = 'love-msg-text';
    el.textContent = loveMsgs[msgIdx % loveMsgs.length]; c.appendChild(el); msgIdx++;
    if (declCount >= 3) launchConfetti();
}

// ================================================================
// TYPEWRITER LETTER
// ================================================================
const LETTER_PARTS = [
    { text: '–ú–æ–π –ª—é–±–∏–º—ã–π —á–µ–ª–æ–≤–µ–∫,\n\n', h: false },
    { text: '–¢—ã ‚Äî —Ç–∞ —Å–∞–º–∞—è, –ø—Ä–∏ –≤–∏–¥–µ –∫–æ—Ç–æ—Ä–æ–π —É –º–µ–Ω—è ', h: false },
    { text: '–∑–∞–º–∏—Ä–∞–µ—Ç —Å–µ—Ä–¥—Ü–µ', h: true },
    { text: '.\n–ö–∞–∂–¥–æ–µ —É—Ç—Ä–æ —è –ø—Ä–æ—Å—ã–ø–∞—é—Å—å —Å –º—ã—Å–ª—å—é –æ —Ç–µ–±–µ, –∏ –∫–∞–∂–¥—ã–π –≤–µ—á–µ—Ä –∑–∞—Å—ã–ø–∞—é,\n–º–µ—á—Ç–∞—è —É–≤–∏–¥–µ—Ç—å ', h: false },
    { text: '—Ç–≤–æ—é —É–ª—ã–±–∫—É', h: true },
    { text: '.\n\n–¢—ã –Ω–∞–ø–æ–ª–Ω—è–µ—à—å –º–æ—é –∂–∏–∑–Ω—å ', h: false },
    { text: '—Å–≤–µ—Ç–æ–º –∏ —Å—á–∞—Å—Ç—å–µ–º', h: true },
    { text: '.\n–†—è–¥–æ–º —Å —Ç–æ–±–æ–π –≤–µ—Å—å –º–∏—Ä —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —è—Ä—á–µ,\n–∞ –≤—Å–µ –ø—Ä–æ–±–ª–µ–º—ã –∫–∞–∂—É—Ç—Å—è –ø—É—Å—Ç—è–∫–∞–º–∏.\n\n–°–ø–∞—Å–∏–±–æ –∑–∞ –∫–∞–∂–¥—ã–π –º–æ–º–µ–Ω—Ç, –∑–∞ –∫–∞–∂–¥—ã–π –≤–∑–≥–ª—è–¥, –∑–∞ ', h: false },
    { text: '–∫–∞–∂–¥–æ–µ –ø—Ä–∏–∫–æ—Å–Ω–æ–≤–µ–Ω–∏–µ', h: true },
    { text: '.\n\n–Ø –ª—é–±–ª—é —Ç–µ–±—è –±–æ–ª—å—à–µ, —á–µ–º –º–æ–≥—É—Ç –≤—ã—Ä–∞–∑–∏—Ç—å –ª—é–±—ã–µ —Å–ª–æ–≤–∞. üíï', h: false },
];
function typewriteLetter() {
    const el = document.getElementById('letterText');
    el.innerHTML = '';
    const cursor = document.createElement('span'); cursor.className = 'letter-cursor'; el.appendChild(cursor);
    let pi = 0, ci = 0, curSpan = null;
    function type() {
        if (pi >= LETTER_PARTS.length) { cursor.remove(); return; }
        const part = LETTER_PARTS[pi];
        if (ci === 0) { curSpan = document.createElement('span'); if (part.h) curSpan.className = 'highlight'; el.insertBefore(curSpan, cursor); }
        if (ci < part.text.length) {
            const ch = part.text[ci];
            if (ch === '\n') curSpan.innerHTML += '<br>'; else curSpan.textContent += ch;
            ci++; setTimeout(type, ch === '\n' ? 180 : 20);
        } else { pi++; ci = 0; setTimeout(type, 18); }
    }
    type();
}

// ================================================================
// MEMORY GAME
// ================================================================
const MEM_EMOJIS = ['‚ù§Ô∏è','üíï','üåπ','üíé','üåü','ü¶ã','üíç','ü•∞'];
let memState = { flipped:[], matched:0, moves:0, locked:false };
function initMemoryGame() {
    const grid = document.getElementById('memoryGrid');
    grid.innerHTML = '';
    document.getElementById('memoryWin').classList.remove('show');
    document.getElementById('memMoves').textContent = '0';
    document.getElementById('memPairs').textContent = '0/8';
    const pairs = [...MEM_EMOJIS,...MEM_EMOJIS].sort(()=>Math.random()-0.5);
    memState = { flipped:[], matched:0, moves:0, locked:false };
    pairs.forEach((emoji,i) => {
        const card = document.createElement('div'); card.className='memory-card'; card.dataset.i=i; card.dataset.emoji=emoji;
        card.innerHTML=`<div class="memory-card-inner"><div class="memory-card-front"><div class="memory-card-front-icon">üíó</div></div><div class="memory-card-back">${emoji}</div></div>`;
        card.addEventListener('click',()=>flipCard(card)); grid.appendChild(card);
    });
}
function flipCard(card) {
    if(memState.locked||card.classList.contains('flipped')||card.classList.contains('matched')) return;
    card.classList.add('flipped'); playClickSound(440+memState.flipped.length*110); memState.flipped.push(card);
    if(memState.flipped.length===2) {
        memState.moves++; document.getElementById('memMoves').textContent=memState.moves; memState.locked=true;
        const [a,b]=memState.flipped;
        if(a.dataset.emoji===b.dataset.emoji) {
            a.classList.add('matched'); b.classList.add('matched'); memState.matched++; document.getElementById('memPairs').textContent=`${memState.matched}/8`; memState.flipped=[]; memState.locked=false; playClickSound(880); launchHeartBurst(a);
            if(memState.matched===8) setTimeout(()=>{ document.getElementById('memoryWin').classList.add('show'); launchConfetti(); launchFireworks(); },500);
        } else {
            setTimeout(()=>{ a.classList.remove('flipped'); b.classList.remove('flipped'); memState.flipped=[]; memState.locked=false; },1050);
        }
    }
}
initMemoryGame();

// ================================================================
// QUIZ
// ================================================================
const QUIZ=[
    { q:'üíï –ö–∞–∫–æ–π —Ü–≤–µ—Ç–æ–∫ —Å—á–∏—Ç–∞–µ—Ç—Å—è —Å–∏–º–≤–æ–ª–æ–º –ª—é–±–≤–∏?', opts:['–†–æ–º–∞—à–∫–∞','–†–æ–∑–∞','–¢—é–ª—å–ø–∞–Ω','–õ–∏–ª–∏—è'], c:1 },
    { q:'üíò –ö–∞–∫ –∑–æ–≤—É—Ç –±–æ–≥–∞ –ª—é–±–≤–∏ –≤ –¥—Ä–µ–≤–Ω–µ—Ä–∏–º—Å–∫–æ–π –º–∏—Ñ–æ–ª–æ–≥–∏–∏?', opts:['–ó–µ–≤—Å','–ú–∞—Ä—Å','–ö—É–ø–∏–¥–æ–Ω','–ê–ø–æ–ª–ª–æ–Ω'], c:2 },
    { q:'üíñ –°–∫–æ–ª—å–∫–æ —É–¥–∞—Ä–æ–≤ –≤ –º–∏–Ω—É—Ç—É –¥–µ–ª–∞–µ—Ç –≤–ª—é–±–ª—ë–Ω–Ω–æ–µ —Å–µ—Ä–¥—Ü–µ?', opts:['60','100+','50','200'], c:1 },
    { q:'üåπ –ù–∞ –∫–∞–∫–æ–º —è–∑—ã–∫–µ "–Ø —Ç–µ–±—è –ª—é–±–ª—é" ‚Äî "Ti amo"?', opts:['–ò—Å–ø–∞–Ω—Å–∫–∏–π','–§—Ä–∞–Ω—Ü—É–∑—Å–∫–∏–π','–ò—Ç–∞–ª—å—è–Ω—Å–∫–∏–π','–ü–æ—Ä—Ç—É–≥–∞–ª—å—Å–∫–∏–π'], c:2 },
    { q:'üíù –ß—Ç–æ —Å–∏–º–≤–æ–ª–∏–∑–∏—Ä—É–µ—Ç –∫—Ä–∞—Å–Ω—ã–π —Ü–≤–µ—Ç –≤ –î–µ–Ω—å –í–∞–ª–µ–Ω—Ç–∏–Ω–∞?', opts:['–î—Ä—É–∂–±—É','–°—Ç—Ä–∞—Å—Ç—å –∏ –ª—é–±–æ–≤—å','–£–¥–∞—á—É','–ë–æ–≥–∞—Ç—Å—Ç–≤–æ'], c:1 },
];
let quizCur=0;
function initQuiz() {
    quizCur=0; quizStarted=true;
    const pd=document.getElementById('puzzleProgress'); pd.innerHTML='';
    QUIZ.forEach((_,i)=>{ const d=document.createElement('div'); d.className='progress-dot'+(i===0?' active':''); pd.appendChild(d); });
    showQuestion();
}
function showQuestion() {
    if(quizCur>=QUIZ.length){ document.getElementById('puzzleContainer').style.display='none'; document.getElementById('puzzleReward').classList.add('show'); launchConfetti(); launchFireworks(); return; }
    const q=QUIZ[quizCur]; document.getElementById('puzzleQuestion').textContent=q.q;
    const od=document.getElementById('puzzleOptions'); od.innerHTML='';
    q.opts.forEach((opt,i)=>{ const btn=document.createElement('button'); btn.className='puzzle-btn'; btn.textContent=opt; btn.onclick=()=>checkAnswer(i,btn); od.appendChild(btn); });
    document.querySelectorAll('.progress-dot').forEach((d,i)=>{ d.className='progress-dot'; if(i<quizCur) d.classList.add('completed'); if(i===quizCur) d.classList.add('active'); });
}
function checkAnswer(idx,btn) {
    const q=QUIZ[quizCur]; document.querySelectorAll('.puzzle-btn').forEach(b=>b.onclick=null);
    if(idx===q.c){ btn.classList.add('correct'); playClickSound(880); setTimeout(()=>{ quizCur++; showQuestion(); },800); }
    else{ btn.classList.add('wrong'); document.querySelectorAll('.puzzle-btn')[q.c].classList.add('correct'); setTimeout(()=>{ quizCur++; showQuestion(); },1200); }
}

// ================================================================
// ENVELOPE
// ================================================================
let envelopeOpened=false;
function openEnvelope() {
    if(envelopeOpened) return; envelopeOpened=true;
    document.getElementById('envelope').textContent='üíü';
    document.getElementById('secretMsg').classList.add('show');
    playClickSound(523); launchConfetti();
    for(let i=0;i<18;i++) setTimeout(()=>createFirework(Math.random()*window.innerWidth,Math.random()*window.innerHeight*0.5),i*180);
}
</script>
</body>
</html>
